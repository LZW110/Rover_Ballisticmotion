SUBROUTINE SEARCH(P)
USE GLOBAL

IMPLICIT NONE
INTEGER:: I,J(2),P
DOUBLE PRECISION ::TMP1,TMP2,TMP3,UV(2),X(3)
I=1D0
P=0D0
OPEN(UNIT=143, FILE='SEARCH.TXT')
!DO WHILE(II.LE.MIAN)  !K为面数
DO WHILE(P.LT.1D0)
   J(1)=I  !id(1)

   CALL RANDOM_SEED()
   CALL RANDOM_NUMBER(TMP1)
   TMP1=0+4D0*TMP1
   J(2)=FLOOR(TMP1)   !随机确定ID(2)
  
!   CALL RANDOM_SEED()
   CALL RANDOM_NUMBER(TMP2)
   UV(1)=TMP2    !随机选U
 !  CALL RANDOM_SEED()
   CALL RANDOM_NUMBER(TMP3)
   UV(2)=0+(1-UV(1))*TMP3 !随机选V
   P=P+1
   I=1+100*P
   A=SMTH(J(1),ODR(:,J(2)),:)
   CALL QFUN(UV(1),UV(2),X)
   WRITE(143,176) J,UV,X
   END DO
   CLOSE(143)
176 FORMAT(I12' ',I12' ',E22.12' ',E22.12' ',E22.12' ',E22.12' ',E22.12)
   RETURN
   END SUBROUTINE SEARCH

   
  
!****************************************************************************
!
!	MODULE GLOBAL: 
!
!****************************************************************************

	MODULE GLOBAL

	IMPLICIT NONE
!ORDER OF VECTORS IN SMTH FOR BEZIER PATCH
	INTEGER, PARAMETER:: ODR(15,3)=(/1,14,20,17,2,5,7,6,4,19,22,16,25,23,24,1,16,22,19,4,11,13,12,&
							    	  3,18,21,15,28,27,26,1,15,21,18,3,9,10,8,2,17,20,14,31,29,30/)
!ANGULAR RATE OF THE POLYHEDRA
	DOUBLE PRECISION, PARAMETER :: OMG(3)=(/0.0D0,0.0D0,6.283185307D0/), PI=3.141592654D0

!INTEGRTING PARAMETERS
	DOUBLE PRECISION :: DT, TEND=2.0D0, TIMEBEGIN, TIMEEND
	INTEGER :: MODE, ID(2),O !=(/3242,3/)
	DOUBLE PRECISION :: SURFINI(4)=(/0.700526069076D0,0.0799458936076D0,0.12D0,0.09D0/)

DOUBLE PRECISION :: ORBINI(6)=(/0.00439,0.002485,0.8427+0.0105,&
                               0.0,    0.0,    0.0/)
!DOUBLE PRECISION :: ORBINI(6)=(/0.0E+00 ,   0.2E+00  ,  1.2E+00 ,  0.0E+00   , -0.0E+00  , -0.0E+00/)
				                        
!DELTA TIME PARAMETER,UNDIMENSIONAL
    DOUBLE PRECISION :: RESO_H=0.01D0, RESO_N=20    

   !COLLISION BACK STEP UNIT
    DOUBLE PRECISION :: CUT=0.8D0
   !LIFOFF FIX STEP
    DOUBLE PRECISION :: LIF=1.01D0
   !HOP RESOLUTION
	INTEGER :: CRS=6

!SURFACE MECHANICAL PROPERTIES
	DOUBLE PRECISION :: EPSN=0.90D0
	DOUBLE PRECISION :: EPST=0.90D0
	DOUBLE PRECISION :: MU=1.2D1
	DOUBLE PRECISION :: MUS=1.7D1

!stop
    DOUBLE PRECISION :: SFV=1.0D-2 !临界速度（单位：0.0163m/s）
	DOUBLE PRECISION :: SFA=1.0D2 !临界加速度（单位：5.9370e-07m/s2）
	DOUBLE PRECISION :: ESR=2.0 !临界逃逸

!GRAVITATIONAL PARAS, UNDIMENSIONAL
	INTEGER :: N_V, N_E, N_F
   !SINGULARITY CHECK ERROR (CRITERION OF DISTANCE TO EDGE)
	DOUBLE PRECISION :: SERR=1.0D-12
   !DYNAMICAL COEFFIECNT OF ASTEROID 
	DOUBLE PRECISION :: KAPPA=13.544D0
	DOUBLE PRECISION :: LU=1.89860350146E+003
	DOUBLE PRECISION :: TU=0.124956000000E+005
	 
	INTEGER, ALLOCATABLE :: ES(:,:), FS(:,:)	
	DOUBLE PRECISION, ALLOCATABLE :: VS(:,:), NES(:,:), LES(:), NFS(:,:)

!SURFACE PARAS, UNIMENSIONAL
	DOUBLE PRECISION :: A(15,3)
	DOUBLE PRECISION, ALLOCATABLE ::  SMTH(:,:,:), SECS(:,:,:)

! 探测器的参数
   	DOUBLE PRECISION :: QINI(4)=(/1.0D0, 0.0D0, 0.0D0, 0.0D0/)  ! 初始四元数
	DOUBLE PRECISION :: WINI(3)=(/0.0D0,0.0D0,0.0D0/)   ! 初始角速度
	DOUBLE PRECISION :: MASS = 10,EDGE = 0.1
	DOUBLE PRECISION :: Jr(3,3) = (/3.7D-8, 0.0D0, 0.0D0, 0.0D0,3.7D-8, 0.0D0, 0.0D0, 0.0D0,3.7D-8/)  !	转动惯量矩阵							
	DOUBLE PRECISION :: INV_Jr(3,3) = (/2.7D7, 0.0D0, 0.0D0, 0.0D0, 2.7D7, 0.0D0, 0.0D0, 0.0D0, 2.7D7/)  ! 逆转动惯量矩阵
!	DOUBLE PRECISION :: Jr(3,3) = (/0.0047614D0, 0.0D0, 0.0D0, 0.0D0, 0.0047614D0, 0.0D0, 0.0D0, 0.0D0, 0.0074011D0/)  !	转动惯量矩阵							
!	DOUBLE PRECISION :: INV_Jr(3,3) = (/210.02230D0, 0.0D0, 0.0D0, 0.0D0, 210.0223D0, 0.0D0, 0.0D0, 0.0D0, 135.11510D0/)  ! 逆转动惯量矩阵
	DOUBLE PRECISION :: CRR=0.04D0
	DOUBLE PRECISION :: pmax=1.0D-10 !一次渗入最大量

	DOUBLE PRECISION :: gforce(3), gtorque(3),gGF(3)

 
	END MODULE GLOBAL
